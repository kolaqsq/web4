# Коды ответа HTTP

Код ответа (состояния) HTTP показывает, был ли успешно выполнен определённый HTTP запрос. Коды сгруппированы в 5
классов:

1. Информационные 100 - 199
2. Успешные 200 - 299
3. Перенаправления 300 - 399
4. Клиентские ошибки 400 - 499
5. Серверные ошибки 500 - 599

Коды состояния определены в [10-ой секции RFC 2616](https://datatracker.ietf.org/doc/html/rfc2616#section-10).
Обновленную спецификацию можно найти в [RFC 7231](https://datatracker.ietf.org/doc/html/rfc7231#section-6.5.1).

## Список всех кодов и их значения

### Информационные

- 100 - Continue.

  *Продолжить.* Этот промежуточный ответ указывает, что запрос успешно принят и клиент может продолжать присылать
  запросы либо проигнорировать этот ответ, если запрос был завершён.

  Актуален только для HTTP/1.1


- 101 - Switching Protocol.

  *Переключение протокола.* Этот код присылается в ответ на запрос клиента, содержащий заголовок Upgrade:, и указывает,
  что сервер переключился на протокол, который был указан в заголовке. Эта возможность позволяет перейти на
  несовместимую версию протокола и обычно не используется.

  Актуален только для HTTP/1.1


- 102 - Processing.

  *В обработке.* Этот код указывает, что сервер получил запрос и обрабатывает его, но обработка ещё не завершена.

  Актуален только для HTTP/1.1


- 103 - Early Hints.

  *Ранние подсказки.* В ответе сообщаются ресурсы, которые могут быть загружены заранее, пока сервер будет
  подготавливать основной ответ. [RFC 8297 (Experimental)](https://datatracker.ietf.org/doc/rfc8297/).

  Актуален только для HTTP/1.1

### Успешные

- 200 - OK.

  *Успешно.* Запрос успешно обработан. Что значит *успешно*, зависит от метода HTTP, который был запрошен:
    - GET: "ПОЛУЧИТЬ". Запрошенный ресурс был найден и передан в теле ответа.
    - HEAD: "ЗАГОЛОВОК". Заголовки переданы в ответе.
    - POST: "ПОСЫЛКА". Ресурс, описывающий результат действия сервера на запрос, передан в теле ответа.
    - TRACE: "ОТСЛЕЖИВАТЬ". Тело ответа содержит тело запроса полученного сервером.

  Актуален для HTTP/0.9 и выше


- 201 - Created.

  *Создано.* Запрос успешно выполнен и в результате был создан ресурс. Этот код обычно присылается в ответ на запрос
  PUT *ПОМЕСТИТЬ.*

  Актуален для HTTP/0.9 и выше


- 202 - Accepted.

  *Принято.* Запрос принят, но ещё не обработан. Не поддерживаемо, т.е., нет способа с помощью HTTP отправить
  асинхронный ответ позже, который будет показывать итог обработки запроса. Это предназначено для случаев, когда запрос
  обрабатывается другим процессом или сервером, либо для пакетной обработки.

  Актуален для HTTP/0.9 и выше


- 203 - Non-Authoritative Information.

  *Информация не авторитетна.* Этот код ответа означает, что информация, которая возвращена, была предоставлена не от
  исходного сервера, а из какого-нибудь другого источника. Во всех остальных ситуациях более предпочтителен код ответа
  200 OK.

  Актуален для HTTP/0.9 и 1.1


- 204 - No Content.

  *Нет содержимого.* Нет содержимого для ответа на запрос, но заголовки ответа, которые могут быть полезны, присылаются.
  Клиент может использовать их для обновления кешированных заголовков полученных ранее для этого ресурса.

  Актуален для HTTP/0.9 и выше


- 205 - Reset Content.

  *Сбросить содержимое.* Этот код присылается, когда запрос обработан, чтобы сообщить клиенту, что необходимо сбросить
  отображение документа, который прислал этот запрос.

  Актуален только для HTTP/1.1


- 206 - Partial Content.

  *Частичное содержимое.* Этот код ответа используется, когда клиент присылает заголовок диапазона, чтобы выполнить
  загрузку отдельно, в несколько потоков.

  Актуален только для HTTP/1.1

### Сообщения о перенаправлениях

- 300 - Multiple Choice.

  *Множественный выбор.* Этот код ответа присылается, когда запрос имеет более чем один из возможных ответов. И
  User-agent или пользователь должен выбрать один из ответов. Не существует стандартизированного способа выбора одного
  из полученных ответов.

  Актуален для HTTP/1.0 и выше


- 301 - Moved Permanently.

  *Перемещён на постоянной основе.* Этот код ответа значит, что URI запрашиваемого ресурса был изменён. Возможно, новый
  URI будет предоставлен в ответе.

  Актуален для HTTP/0.9 и выше


- 302 - Found.

  *Найдено.* Этот код ответа значит, что запрошенный ресурс временно изменён. Новые изменения в URI могут быть доступны
  в будущем. Таким образом, этот URI, должен быть использован клиентом в будущих запросах.

  Актуален для HTTP/0.9 и выше


- 303 - See Other.

  *Просмотр других ресурсов.* Этот код ответа присылается, чтобы направлять клиента для получения запрашиваемого ресурса
  в другой URI с запросом GET.

  Актуален для HTTP/0.9 и 1.1


- 304 - Not Modified.

  *Не модифицировано.* Используется для кеширования. Это код ответа значит, что запрошенный ресурс не был изменён. Таким
  образом, клиент может продолжать использовать кешированную версию ответа.

  Актуален для HTTP/0.9 и выше


- 305 - Use Proxy.

  *Использовать прокси.* Это означает, что запрошенный ресурс должен быть доступен через прокси. Этот код ответа в
  основном не поддерживается из соображений безопасности.

  Актуален только для HTTP/1.1


- 306 - Switch Proxy.

  Больше не использовать. Изначально подразумевалось, что *последующие запросы должны использовать указанный прокси.*

  Актуален только для HTTP/1.1


- 307 - Temporary Redirect.

  *Временное перенаправление.* Сервер отправил этот ответ, чтобы клиент получил запрошенный ресурс на другой URL-адрес с
  тем же методом, который использовал предыдущий запрос. Данный код имеет ту же семантику, что код ответа 302 Found, за
  исключением того, что агент пользователя не должен изменять используемый метод HTTP: если в первом запросе
  использовался POST, то во втором запросе также должен использоваться POST.

  Актуален только для HTTP/1.1


- 308 - Permanent Redirect.

  *Перенаправление на постоянной основе.* Это означает, что ресурс теперь постоянно находится в другом URI, указанном в
  заголовке Location: HTTP Response. Данный код ответа имеет ту же семантику, что и код ответа 301 Moved Permanently, за
  исключением того, что агент пользователя не должен изменять используемый метод HTTP: если POST использовался в первом
  запросе, POST должен использоваться и во втором запросе.

  > Примечание: Это экспериментальный код ответа, Спецификация которого в настоящее время находится в [черновом виде](https://greenbytes.de/tech/webdav/draft-reschke-http-status-308-07.html).

### Клиентские

- 400 - Bad Request.

  *Плохой запрос.* Этот ответ означает, что сервер не понимает запрос из-за неверного синтаксиса.

  Актуален для HTTP/0.9 и выше


- 401 - Unauthorized.

  *Неавторизованно.* Для получения запрашиваемого ответа нужна аутентификация. Статус похож на статус 403, но, в этом
  случае, аутентификация возможна.

  Актуален для HTTP/0.9 и выше


- 402 - Payment Required .

  *Необходима оплата.* Этот код ответа зарезервирован для будущего использования. Первоначальная цель для создания этого
  когда была в использовании его для цифровых платёжных систем(на данный момент не используется).

  Актуален для HTTP/0.9 и 1.1


- 403 - Forbidden.

  *Запрещено.* У клиента нет прав доступа к содержимому, поэтому сервер отказывается дать надлежащий ответ.

  Актуален для HTTP/0.9 и выше


- 404 - Not Found.

  *Не найден.* Сервер не может найти запрашиваемый ресурс. Код этого ответа, наверно, самый известный из-за частоты его
  появления в вебе.

  Актуален для HTTP/0.9 и выше


- 405 - Method Not Allowed .

  *Метод не разрешён.* Сервер знает о запрашиваемом методе, но он был деактивирован и не может быть использован. Два
  обязательных метода, GET и HEAD, никогда не должны быть деактивированы и не должны возвращать этот код ошибки.

  Актуален только для HTTP/1.1


- 406 - Not Acceptable.

  Этот ответ отсылается, когда веб сервер после выполнения server-driven content negotiation, не нашёл контента,
  отвечающего критериям, полученным из user agent.

  Актуален только для HTTP/1.1


- 407 - Proxy Authentication Required.

  Этот код ответа аналогичен коду 401, только аутентификация требуется для прокси сервера.

  Актуален только для HTTP/1.1


- 408 - Request Timeout.

  Ответ с таким кодом может прийти, даже без предшествующего запроса. Он означает, что сервер хотел бы отключить это
  неиспользуемое соединение. Этот метод используется все чаще с тех пор, как некоторые браузеры, вроде Chrome и IE9,
  стали
  использовать [HTTP механизмы предварительного соединения](https://www.belshe.com/2011/02/10/the-era-of-browser-preconnect/)
  для ускорения сёрфинга (смотрите [баг 634278](https://bugzilla.mozilla.org/show_bug.cgi?id=634278), будущей реализации
  этого механизма в Firefox). Также учитывайте, что некоторые серверы прерывают соединения не отправляя подобных
  сообщений.

  Актуален только для HTTP/1.1


- 409 - Conflict.

  Этот ответ отсылается, когда запрос конфликтует с текущим состоянием сервера.

  Актуален только для HTTP/1.1


- 410 - Gone.

  Этот ответ отсылается, когда запрашиваемый контент удалён с сервера.

  Актуален только для HTTP/1.1


- 411 - Length Required.

  Запрос отклонён, потому что сервер требует указание заголовка `Content-Length`, но он не указан.

  Актуален только для HTTP/1.1


- 412 - Precondition Failed .

  Клиент указал в своих заголовках условия, которые сервер не может выполнить.

  Актуален только для HTTP/1.1


- 413 - Request Entity Too Large.

  Размер запроса превышает лимит, объявленный сервером. Сервер может закрыть соединение, вернув заголовок `Retry-After`.

  Актуален только для HTTP/1.1


- 414 - Request-URI Too Long.

  URI запрашиваемый клиентом слишком длинный для того, чтобы сервер смог его обработать.

  Актуален только для HTTP/1.1


- 415 - Unsupported Media Type.

  Медиа формат запрашиваемых данных не поддерживается сервером, поэтому запрос отклонён.

  Актуален только для HTTP/1.1


- 416 - Requested Range Not Satisfiable.

  Диапазон указанный заголовком запроса `Range` не может быть выполнен; возможно, он выходит за пределы переданного URI.

  Актуален только для HTTP/1.1


- 417 - Expectation Failed.

  Этот код ответа означает, что ожидание, полученное из заголовка запроса `Expect`, не может быть выполнено сервером.

  Актуален только для HTTP/1.1

### Серверные

- 500 - Internal Server Error.

  *Внутренняя ошибка сервера.* Сервер столкнулся с ситуацией, которую он не знает как обработать.

  Актуален для HTTP/0.9 и выше


- 501 - Not Implemented.

  *Не выполнено.* Метод запроса не поддерживается сервером и не может быть обработан. Единственные методы, которые
  сервера должны поддерживать (и, соответственно, не должны возвращать этот код) - GET и HEAD.

  Актуален для HTTP/0.9 и выше


- 502 - Bad Gateway.

  *Плохой шлюз.* Эта ошибка означает что сервер, во время работы в качестве шлюза для получения ответа, нужного для
  обработки запроса, получил недействительный (недопустимый) ответ.

  Актуален для HTTP/0.9 и выше


- 503 - Service Unavailable.

  *Сервис недоступен.* Сервер не готов обрабатывать запрос. Зачастую причинами являются отключение сервера или то, что
  он перегружен. Обратите внимание, что вместе с этим ответом удобная для пользователей(user-friendly) страница должна
  отправлять объяснение проблемы. Этот ответ должен использоваться для временных условий и `Retry-After:` HTTP-заголовок
  должен, если возможно, содержать предполагаемое время до восстановления сервиса. Веб-мастер также должен позаботиться
  о заголовках, связанных с кешем, которые отправляются вместе с этим ответом, так как эти ответы, связанные с
  временными условиями, обычно не должны кешироваться.

  Актуален для HTTP/0.9 и выше


- 504 - Gateway Timeout.

  Этот ответ об ошибке предоставляется, когда сервер действует как шлюз и не может получить ответ вовремя.

  Актуален только для HTTP/1.1


- 505 - HTTP Version Not Supported.

  *HTTP-версия не поддерживается.* HTTP-версия, используемая в запросе, не поддерживается сервером.

  Актуален только для HTTP/1.1

## HTTP ответы на примере API

- Успешные:
    - 200: Ok
    - 201: Created
    - 204: No content
- Клиентские ошибки
    - 400: Bad Request
    - 401: Unauthorized
    - 404: Not Found
- Серверные ошибки
    - 500: Internal Server Error
    - 504: Gateway Timeout

Запросы будем слать из [Postman](https://www.postman.com/)

### 200: Ok

Делаем запрос GET на адрес: `http://tutorial-api.local:8081/api/v1/clinics`

Приходит ответ с данными в теле и кодом 200

### 201: Created

Делаем запрос POST на адрес: `http://tutorial-api.local:8081/api/v1/clinics`

И в теле шлем JSON

```json
{
  "name": "ГОСУДАРСТВЕННОЕ БЮДЖЕТНОЕ УЧРЕЖДЕНИЕ РЯЗАНСКОЙ ОБЛАСТИ \"ГОРОДСКАЯ ДЕТСКАЯ ПОЛИКЛИНИКА № 77\"",
  "address": "Россия, 390023, обл Рязанская, г Рязань, ул Циолковского, д.12",
  "phone": "74912445777"
}
```

Приходит ответ с данными в теле и кодом 201

### 204: No content

Делаем запрос DELETE на адрес: `http://tutorial-api.local:8081/api/v1/clinics/60cda6c4d228bf19c11ee692`

Приходит ответ с данными в теле и кодом 204 так как контент удален -> показывать нечего, но полезные заголовки пришли.

### 400: Bad Request

Делаем запрос POST на адрес: `http://tutorial-api.local:8081/api/v1/clinics`

И в теле шлем JSON с неверным синтаксисом: запятая в конце

```json
{
  "name": "ГОСУДАРСТВЕННОЕ БЮДЖЕТНОЕ УЧРЕЖДЕНИЕ РЯЗАНСКОЙ ОБЛАСТИ \"ГОРОДСКАЯ ДЕТСКАЯ ПОЛИКЛИНИКА № 77\"",
  "address": "Россия, 390023, обл Рязанская, г Рязань, ул Циолковского, д.12",
  "phone": "74912445777"
}
```

Приходит ответ с данными в теле и кодом 400

```json
{
  "message": "Invalid json message received",
  "code": 400
}
```

### 401: Unauthorized

Делаем запрос GET на адрес: `http://tutorial-api.local:8081/api/v1/clinics`

И в заголовке `X-AUTH-TOKEN` меняем один символ, так что этот токен становится недействительный.

Приходит ответ с кодом 401

```json
{
  "message": "Invalid credentials."
}
```

### 404: Not Found

Делаем запрос PUT на адрес: `http://tutorial-api.local:8081/api/v1/clinics/appointments/60cd094b1217d54f694c2e9f` причем
в адрес мы передаем id талона которого не существует

И в теле шлем JSON с данными которые нужно вставить

```json
{
  "date": "2021-08-16T08:30:00.000Z",
  "specialization": "Прием невролога"
}
```

Приходит ответ с данными в теле и кодом 404

```json
{
  "message": "Appointment not found",
  "code": 404
}
```

### 500: Internal Server Error

Сначала сломаем логику отвечающую за вывод списка клиник. И сделаем
запрос GET на адрес: `http://tutorial-api.local:8081/api/v1/clinics`, чтобы получить этот список

Приходит ответ с сообщением в теле и кодом 500

```json
{
  "message": "Server error. Dont worry we already know about it.",
  "code": 500
}
```

### 504: Gateway Timeout

Сначала остановим контейнер с PHP. И сделаем запрос GET на адрес: `http://tutorial-api.local:8081/api/v1/clinics`, чтобы
получить этот список

Приходит ответ от nginx с сообщением в теле и кодом 504

```html

<html>

<head>
    <title>504 Gateway Time-out</title>
</head>

<body>
<center>
    <h1>504 Gateway Time-out</h1>
</center>
<hr>
<center>nginx/1.21.0</center>
</body>

</html>
```

---

*Источник: https://developer.mozilla.org/ru/docs/Web/HTTP/Status*
